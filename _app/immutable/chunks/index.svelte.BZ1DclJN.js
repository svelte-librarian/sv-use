import{D as c,v as o,T as g,w as m}from"./runtime.BtYRUgJo.js";import{p as h}from"./proxy.pxA-SMcc.js";import{w as d}from"./index.svelte.JYs1x1jk.js";function y(r,p,i={}){const{includeCurrent:a=!1}=i;let n=c(h([]));const t=h([]);let e="change";return d(()=>r(),(s,u)=>{e==="change"?g(()=>{t.push({snapshot:a?s:u,timestamp:Date.now()}),m(n,h([]))}):e="change"},{runOnMounted:a}),{get canUndo(){return a?t.length>1:t.length>0},get canRedo(){return o(n).length>0},get history(){return t},get redoHistory(){return o(n)},undo(){if(a){if(t.length>=2){const s=t.at(-2);t.pop(),e="undo",o(n).push({snapshot:r(),timestamp:Date.now()}),p(s.snapshot)}}else if(t.length>0){const s=t.pop();e="undo",o(n).push({snapshot:r(),timestamp:Date.now()}),p(s.snapshot)}},redo(){if(o(n).length>0){const s=o(n).pop();e="redo",t.push({snapshot:r(),timestamp:Date.now()}),p(s.snapshot)}}}}export{y as t};
